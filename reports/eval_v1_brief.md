# Eval V1 Brief（截至：2025-09-03）

## 1) 关键指标（离线结构）

| 指标 | 当前值 | 目标阈值 | 状态 |
|------|--------|----------|------|
| **结构完整率** | 100.0% | ≥95% | ✅ 优秀 |
| **Clarification覆盖率** | 100.0% | ≥90% | ✅ 优秀 |
| **Branch一致性** | 42.6% | ≥80% | ❌ 严重不足 |
| **冗余率** | 14.3% | ≤20% | ✅ 可接受 |
| **查询长度P50/P90** | 46/81 字符 | 40-100 | ✅ 合理 |
| **回答长度P50/P90** | 35/99 字符 | 30-120 | ✅ 合理 |
| **澄清问长度P50/P90** | 59/86 字符 | 50-90 | ✅ 合理 |

> **结论**：Branch一致性42.6%是最大短板，影响模型学习效果；其他指标表现良好，数据质量基础扎实。

## 2) 误差类型 Top-3（各配1例）

### 1. **Branch不一致**（42.6%占比，643个样本）
**现象**: 澄清问数量与回答分支数量不匹配
**根因**: 生成时未严格遵循"1问1答"原则，或后处理时丢失对应关系
**改法**: 在数据生成pipeline中增加强制校验，确保`len(clarification_questions) == len(assistant_response_branches)`

**示例**:
- UID: `shard-005-078`
- 澄清问: 2个（"问题涉及哪个具体年份？", "是财务数据还是运营数据？"）
- 回答分支: 1个（统一回答了所有情况）
- **问题**: 回答没有按澄清问分支化

### 2. **澄清问冗余**（14.3%占比，306个冗余问）
**现象**: 多个澄清问指向相同信息需求
**根因**: 生成算法未做问句去重，或业务逻辑重复
**改法**: 增加问句相似度检测，使用MinHash或编辑距离过滤冗余问

**示例**:
- UID: `shard-003-045`
- 冗余问对: "需要什么额外信息？" vs "还需要了解哪些方面？"
- **问题**: 两个问句语义相同但表述不同

### 3. **回答质量参差**（长度控制P90过高）
**现象**: 部分回答过长（最大463字符），影响模型生成效率
**根因**: 没有长度约束，或复杂问题需要详细回答但缺乏裁剪
**改法**: 在prompt中增加"保持回答简洁"的指令，设置最大长度限制

**示例**:
- UID: `shard-001-089`
- 回答长度: 463字符
- **问题**: 回答过于详细，包含过多背景信息

## 3) 样例（3条）

### 样例1: 高质量样本
- **UID**: `shard-005-042`
- **用户问题**: "公司的季度营收增长了15%，这对股价有什么影响？"
- **澄清问**: ["这是哪个行业的公司？", "营收增长是否可持续？"]
- **回答**: ["科技行业：通常利好，股价可能上涨10-20%", "不可持续：股价可能回调5-15%"]
- **评测要点**: Branch一致性良好，澄清问信息增益高，回答简洁有效

### 样例2: Branch不一致问题
- **UID**: `shard-005-078`
- **用户问题**: "投资回报率如何计算？"
- **澄清问**: ["是财务回报率还是时间回报率？", "计算周期是多久？"]
- **回答**: ["投资回报率=(收入-成本)/成本×100%，通常用百分比表示"]
- **评测要点**: 澄清问提出2个维度，但回答没有分支化，缺少对应关系

### 样例3: 澄清问冗余问题
- **UID**: `shard-003-045`
- **用户问题**: "如何评估供应链效率？"
- **澄清问**: ["需要评估哪些具体指标？", "评估的是哪个环节？", "需要什么额外信息？", "还需要了解哪些方面？"]
- **回答**: ["需要评估库存周转率、交货准时率、成本效率等", "供应商交货时间、仓储效率、生产周期等", "行业基准数据和历史表现", "竞争对手表现和市场趋势"]
- **评测要点**: 第3、4个澄清问语义重复，信息增益不高

## 4) 下周改进清单（可执行）

### 高优先级（Branch一致性修复）
- [ ] **修复数据生成pipeline**（负责人：数据工程师，截止：2025-09-10）
  - 在`synthesis`脚本中增加`len(questions) == len(answers)`校验
  - 添加单元测试确保问答对应关系正确
  - 产出：更新所有shard的branch一致性 >80%

- [ ] **增加后处理校验**（负责人：质量工程师，截止：2025-09-08）
  - 创建`validate_branch_consistency.py`脚本
  - 扫描所有数据检查并修复不一致样本
  - 产出：branch一致性提升至70%以上

### 中优先级（质量优化）
- [ ] **澄清问去重优化**（负责人：算法工程师，截止：2025-09-12）
  - 实现基于编辑距离的问句相似度检测
  - 在生成pipeline中过滤冗余问句
  - 产出：冗余率降低至<10%

- [ ] **回答长度控制**（负责人：提示工程师，截止：2025-09-10）
  - 更新所有数据集的生成prompt，增加长度限制
  - 添加"保持回答简洁"的指令
  - 产出：回答P90降低至80字符以内

### 监控指标
- [ ] **建立质量监控dashboard**（负责人：DevOps，截止：2025-09-15）
  - 集成CI质量检查到开发流程
  - 创建质量趋势图表
  - 产出：实时质量监控系统

## 5) 数据来源与方法

* **数据来源**: `artifacts/quality/2025-09-03/metrics_eval_v1.json`
* **评估方法**: 纯离线结构化评估，无外部LLM调用
* **样本量**: 1120个训练样本，覆盖所有shard
* **评估维度**: 结构完整性、澄清覆盖、分支一致性、冗余检测、长度控制

---

**总结**: 当前数据集在结构完整性和澄清覆盖方面表现优秀，但在分支一致性方面存在明显短板。这是下一阶段优化的重点方向。
